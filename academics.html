<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Results ‚Äì Thamaga JSS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <style>
        body {
            background-color: #f8f9fa;
        }
        .highlight-row {
            background-color: #e6f7ff;
        }
        .score-bar {
            height: 8px;
            border-radius: 4px;
        }
        .score-bar.success {
            background-color: #198754;
        }
        .score-bar.warning {
            background-color: #ffc107;
        }
        .score-bar.danger {
            background-color: #dc3545;
        }
        .tooltip-icon {
            font-size: 0.9rem;
            margin-left: 6px;
            cursor: pointer;
            color: #6c757d;
        }
    </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
    <div class="container">
        <a class="navbar-brand fw-bold d-flex align-items-center" href="home.html">
            <img src="images.jpeg" alt="Thamsec Logo" width="40" height="40" class="me-2"/>
            <span>THAMAGA JUNIOR SECONDARY SCHOOL</span>
        </a>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" href="home.html">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="about.html">About Us</a></li>
                <li class="nav-item"><a class="nav-link" href="academics.html">Academics</a></li>
                <li class="nav-item"><a class="nav-link active" href="discover.html">Discover</a></li>
                <li class="nav-item"><a class="nav-link" href="contact.html">Contact Us</a></li>
            </ul>
        </div>
    </div>
</nav>

<!-- Main Content -->
<div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-primary">üìä Jce Past Results Tracker</h2>
        <button id="toggleAdminBtn" class="btn btn-outline-secondary btn-sm">Login as Admin</button>
    </div>

    <!-- Admin Form -->
    <form id="result-form" class="row g-3 mb-4 d-none">
        <div class="col-md-3">
            <label for="year" class="form-label">Year</label>
            <input type="number" class="form-control" id="year" min="2000" required />
        </div>
        <div class="col-md-3">
            <label for="gardeScore" class="form-label">Grades</label>
            <input type="text" class="form-control" id="className" placeholder="e.g. Grade 10" required />
        </div>
        <div class="col-md-3">
            <label for="averageScore" class="form-label">Average Score (%)</label>
            <input type="number" class="form-control" id="averageScore" min="0" max="100" required />
        </div>
         <div class="col-md-3">
            <label for="averageScore" class="form-label">Position</label>
            <input type="number" class="form-control" id="averageScore" min="0" max="100" required />
        </div>
        <div class="col-md-3 d-flex align-items-end">
            <button type="submit" class="btn btn-success w-100">‚ûï Add Result</button>
        </div>
    </form>

    <!-- Summary -->
    <div id="summary" class="mb-4 fw-bold text-muted"></div>

    <!-- Results Table -->
    <div class="table-responsive">
        <table class="table table-hover" id="results-table">
            <thead class="table-dark">
            <tr>
                <th>Year</th>
                <th>Grades</th>
                <th>Average</th>
                <th>Position</th>
                <th>
                    Chart
                    <span class="tooltip-icon" data-bs-toggle="tooltip" title="Green: ‚â•75% ‚Ä¢ Yellow: 50‚Äì74% ‚Ä¢ Red: <50%">‚ÑπÔ∏è</span>
                </th>
                <th id="action-header" class="text-end d-none">Actions</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const academicResults = JSON.parse(localStorage.getItem("results")) || [
        { year: 2023, className: "Grade 11", averageScore: 78 },
        { year: 2022, className: "Grade 10", averageScore: 72 }
    ];

    let isAdmin = false;
    const form = document.getElementById("result-form");
    const toggleAdminBtn = document.getElementById("toggleAdminBtn");
    const tableBody = document.querySelector("#results-table tbody");
    const summary = document.getElementById("summary");
    const actionHeader = document.getElementById("action-header");

    function saveResults() {
        localStorage.setItem("results", JSON.stringify(academicResults));
    }

    function renderResults() {
        tableBody.innerHTML = "";
        let total = 0;
        const sorted = [...academicResults].sort((a, b) => b.year - a.year);
        sorted.forEach((result, index) => {
            total += result.averageScore;
            const isLatest = index === 0;
            const barColor = result.averageScore >= 75 ? "success" :
                result.averageScore >= 50 ? "warning" : "danger";

            const row = document.createElement("tr");
            row.className = isLatest ? "highlight-row" : "";
            row.innerHTML = `
        <td>${result.year}</td>
        <td>${result.className}</td>
        <td>${result.averageScore}%</td>
        <td><div class="score-bar ${barColor}" style="width: ${result.averageScore}%;"></div></td>
        <td class="text-end">${isAdmin ? `<button class="btn btn-sm btn-outline-danger" onclick="deleteResult(${index})">üóë Delete</button>` : ""}</td>
      `;
            tableBody.appendChild(row);
        });

        summary.textContent = `üìò Overall Average: ${(total / academicResults.length).toFixed(1)}% across ${academicResults.length} classes`;
        actionHeader.classList.toggle("d-none", !isAdmin);
    }

    function deleteResult(index) {
        academicResults.splice(index, 1);
        saveResults();
        renderResults();
    }

    function toggleAdminAccess() {
        if (!isAdmin) {
            const input = prompt("Enter admin password:");
            if (input !== "123@thamagaJSS") return;
        }
        isAdmin = !isAdmin;
        form.classList.toggle("d-none", !isAdmin);
        toggleAdminBtn.textContent = isAdmin ? "Logout Admin" : "Login as Admin";
        renderResults();
    }

    form.addEventListener("submit", (e) => {
        e.preventDefault();
        const year = parseInt(document.getElementById("year").value);
        const className = document.getElementById("className").value.trim();
        const averageScore = parseFloat(document.getElementById("averageScore").value);
        if (!year || !className || isNaN(averageScore)) return;
        academicResults.push({ year, className, averageScore });
        saveResults();
        renderResults();
        form.reset();
    });

    toggleAdminBtn.addEventListener("click", toggleAdminAccess);
    renderResults();

    // Enable tooltips
    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    tooltipTriggerList.map(el => new bootstrap.Tooltip(el));
</script>
</body>
</html>